/*! wizer 0.1 2015-10-30 */
!function(a){"use strict";a&&(a.module("wizer.data",[]),a.module("wizer.sharepoint",["wizer.data"]),a.module("wizer",["wizer.data","wizer.sharepoint"]))}(angular);var wizer=function(a,b){"use strict";var c=function(a){var d=b.isFunction(this)?Object.create(this.prototype):{},e={init:function(){}};b.extend(d,e,a),b.forEach(b.functions(d),function(a){if(d.hasOwnProperty(a)){var c=d[a];d[a]=function(){var a=this.$super;this.$super=d.__proto__;var e=c.apply(this,b.slice(arguments));return void 0===a?delete this.$super:this.$super=a,e}}});var f=function(){d.init.apply(this,b.slice(arguments))};return f.prototype=d,f.extend=c,f};return a.Class=c(),a}(wizer||{},_),wizer=wizer||{};wizer.sharepoint=function(a,b){"use strict";return a.SPList=wizer.Class.extend({init:function(a){!function(){var c=["siteUrl","listName"];if(!a)throw new Error("Configs must be specified.");b.forEach(c,function(b){if(!a[b])throw new Error(String.format("Config's '{0}' field is mandatory.",b))})}(),this.$configs=b.defaultsDeep({},a,{siteUrl:null,listName:null,dataSource:{}})},get:function(a,b){console.log(arguments)},getAll:function(a,b){},create:function(a,b){},createAll:function(a,b){},update:function(a,b){},updateAll:function(a,b){},remove:function(a,b){},removeAll:function(a,b){},dataSource:function(a){return null!=a&&(this.$configs.dataSource=a),this.$configs.dataSource}}),a}(wizer.sharepoint||{},_);var wizer=wizer||{};wizer.sharepoint=function(a){"use strict";return a.SPDocumentLibrary=a.SPList.extend({init:function(){}}),a}(wizer.sharepoint||{}),function(a,b,c){"use strict";a&&a.module("wizer.data").factory("$$DataSource",["$q",function(a){return b.data.DataSource.extend({init:function(a){this.$super.init.call(this,a)},get:function(b,d){var e=c.get(this,"transport.read");return e?c.isFunction(e)?a.when(e.call(this,{itemId:b,httpConfigs:d})):void 0:a.reject("No read transport configurations")},add:function(b,d){var e=c.get(this,"transport.create");return e?c.isFunction(e)?a.when(e.call(this,{item:b,httpConfigs:d})):void 0:a.reject("No create transport configurations")}})}])}(angular,wizer,_),function(a,b,c){"use strict";a&&a.module("wizer.data").factory("$$SPRestDataSource",["$q","$http","$$DataSource",function(a,b,d){var e={create:function(){return{headers:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()}}},get:function(){return{headers:{accept:"application/json;odata=verbose"}}}},f=function(a,b){return c.chain({}).extend(b,{__metadata:{type:"SP.Data."+a+"Item"}}).omit(["Id","ID"]).value()},g={init:function(a){this.$super.init.call(this,a)},transport:{create:function(a){return b.post(this.getItemUrl(),f(this.$configs.listName,a.item),c.extendClone(e.create(),a.httpConfigs))},read:function(a){return b.get(this.getItemUrl(a.itemId),c.extendClone(e.get(),a.httpConfigs))}},getListUrl:function(){return String.format("http://{0}/_api/lists/getByTitle('{1}')",this.$configs.siteUrl,this.$configs.listName)},getItemUrl:function(a){var b=this.getListUrl()+"/items";return b+=a>0?String.format("({0})",a):""}};return d.extend(g)}])}(angular,wizer,_),function(a,b){"use strict";b&&b.module("wizer.sharepoint").factory("$$SPList",["$q","$http","$$SPRestDataSource",function(b,c,d){return a.sharepoint.SPList.extend({init:function(a){a=_.defaultsDeep({},a,{dataSource:new d({siteUrl:a.siteUrl,listName:a.listName})}),this.$super.init.call(this,a)},get:function(a,b){return this.dataSource().get(a,b)},create:function(a,b){return this.dataSource().add(a,b)}})}])}(wizer,angular);var wizer=wizer||{};wizer.data=function(a,b,c){"use strict";var d={};return d.init=function(a){var d=b.defaultsDeep({},a,{data:c,requestSchema:{},responseSchema:{data:c,requestSchema:{},parse:function(a){return a}},transport:{create:{},read:{},update:{},remove:{}}});d.data&&(d.data=b.clone(d.data)),this.$configs=d},d.add=function(a){return this.$configs.data?this.$configs.data.push(a):void 0},d.get=function(a){},d.update=function(a){},d.remove=function(a){},d.data=function(){return this.$configs.data?this.$configs.data:void 0},d.sendRequest=function(a,b,c,d,e){throw new Error("Sub class must implement this method.")},a.DataSource=wizer.Class.extend(d),a}(wizer.data||{},_);var wizer=wizer||{};wizer.data=function(a,b,c){"use strict";var d=function(a){var e=b.defaultsDeep({},a,{id:"id",fields:{}});b.forEach(e.fields,function(a,d){e.fields[d]=b.defaultsDeep({},a,{defaultValue:c,from:c,parse:function(a){return a}})});var f=this.extend({init:function(a){this.$$data=a,this.$$local={},this.__proto__.$configs=b.defaultsDeep(e,this.$super.$configs)}});return f.define=d,f},e=wizer.Class.extend({get:function(a){if(this.$$data){if(this.$$local[a]!==c)return this.$$local[a];var b=this.$configs.fields[a];if(!b)return this.$$data[a];var d=b.from||a,e=b.parse(this.$$data[d]);return e===c?b.defaultValue:e}},set:function(a,b){return b===c?delete this.$$local[a]:this.$$local[a]=b,b}});return e.define=d,a.Model=e,a}(wizer.data||{},_),function(a){"use strict";String.format||(String.format=function(a){var b=Array.prototype.slice.call(arguments,1);return a.replace(/{(\d+)}/g,function(a,c){return"undefined"!=typeof b[c]?b[c]:a})}),a.mixin({extendClone:function(b){return a.extend.apply(a,[{},b].concat(a.rest(arguments)))}})}(_);
//# sourceMappingURL=wizer.min.js.map